<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Feed configuration. -->
    <link href="https://patrick.cloke.us/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Patrick Cloke Atom Feed" />
    <link href="https://patrick.cloke.us/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Patrick Cloke RSS Feed" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link rel="stylesheet" href="/theme/css/styles.css">
    <link rel="stylesheet" href="/theme/css/borland.css">
    <link rel="stylesheet" href="/theme/css/youtube.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

    <title>Matrix Push Rules & Notifications</title>

    <meta property="og:site_name" content="Patrick Cloke" />
<meta property="og:title" content="Matrix Push Rules & Notifications" />
<meta property="og:url" content="https://patrick.cloke.us/posts/2023/05/08/matrix-push-rules-notifications/" />
<meta property="og:description" content="In a previous post about read receipts & notifications in Matrix I briefly mentioned that push rules generate notifications, but with little detail. After completing a rather large project to improve notifications in Matrix I want to fill in some of those blanks. [1] Note These notes are true as of …" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-05-08T14:56:00-04:00" />
<meta property="article:author" content="Patrick Cloke" />
<meta property="article:tag" content="matrix" />

    <script async defer data-domain="cloke.us" src="https://plausible.io/js/plausible.js"></script>
  </head>

  <body class="pb-5">
    <nav class="navbar navbar-expand-lg sticky-top navbar-light bg-light border-bottom border-info">
      <a class="navbar-brand" href="/">
        Patrick Cloke
      </a>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-items" aria-controls="navbar-items" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbar-items">
        <ul class="navbar-nav ml-auto">

          <li class="nav-item">
            <a class="nav-link" href="/pages/about.html">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/pages/projects.html">Projects</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/archives.html">Archives</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/tags.html">Tags</a>
          </li>

          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="social-dropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Social
            </a>

            <span class="dropdown-menu dropdown-menu-right" aria-labelledby="social-dropdown">
              <a class="dropdown-item" href="https://mastodon.social/@clokep" target="_blank">
                  <span class="fab fa-mastodon mr-1"></span>
                mastodon
              </a>
              <a class="dropdown-item" href="https://www.twitter.com/clokep" target="_blank">
                  <span class="fab fa-twitter mr-1"></span>
                twitter
              </a>
              <a class="dropdown-item" href="https://matrix.to/#/@clokep:matrix.org" target="_blank">
                  <span class="pl-3 mr-2"></span>
                matrix
              </a>
              <a class="dropdown-item" href="https://github.com/clokep" target="_blank">
                  <span class="fab fa-github mr-1"></span>
                github
              </a>
              <a class="dropdown-item" href="https://gitlab.com/clokep" target="_blank">
                  <span class="fab fa-gitlab mr-1"></span>
                gitlab
              </a>
            </div>
          </li>

          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="feeds-dropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Feeds
            </a>

            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="feeds-dropdown">
              <a class="dropdown-item" href="https://patrick.cloke.us/feeds/atom.xml" type="application/atom+xml" rel="alternate">atom feed</a>
              <a class="dropdown-item" href="https://patrick.cloke.us/feeds/rss.xml" type="application/rss+xml" rel="alternate">rss feed</a>
            </div>
          </li>

          <form class="form-inline" method="get" action="http://www.google.com/search">
            <input class="form-control form-control-sm mr-sm-2" type="search" name="q" placeholder="Search" aria-label="Search" />
            <input type="hidden"  name="sitesearch" value="patrick.cloke.us" />

            <button class="btn btn-sm btn-outline-info d-none d-sm-inline" type="submit">Search</button>
          </form>
        </ul>
      </div>
    </nav>

<div class="container">
  <div class="row">
    <div class="col-md-12 mt-2 mb-2">
      <h1>
        <a href="/posts/2023/05/08/matrix-push-rules-notifications/" rel="bookmark"
           title="Permalink to Matrix Push Rules & Notifications">Matrix Push Rules <span class="amp">&amp;</span>&nbsp;Notifications</a>
      </h1>

      <div class="row">
        <div class="col-sm">
          <span class="text-secondary font-weight-light font-italic">Published on Monday, May 8, 2023</span>

          <br>
          <span class="text-secondary font-weight-light font-italic">
            Tags:               <a href="/tag/matrix.html">matrix</a>          </span>
        </div>

        <div class="col-sm text-right">
          <a href="https://twitter.com/intent/tweet?text=Matrix%20Push%20Rules%20%26%C2%A0Notifications&url=https%3A//patrick.cloke.us/posts/2023/05/08/matrix-push-rules-notifications/&hashtags=matrix" target="_blank" class="ml-1 mr-1" title="Share on Twitter">
            <span class="fab fa-twitter"></span>
          </a>
          <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//patrick.cloke.us/posts/2023/05/08/matrix-push-rules-notifications/" target="_blank" class="ml-1 mr-1" title="Share on Facebook">
            <span class="fab fa-facebook"></span>
          </a>
          <a href="mailto:?subject=Matrix%20Push%20Rules%20%26%C2%A0Notifications&amp;body=https%3A//patrick.cloke.us/posts/2023/05/08/matrix-push-rules-notifications/" target="_blank" class="ml-1 mr-1" title="Share via Email">
            <span class="fas fa-envelope"></span>
          </a>
        </div>
      </div>

      <hr>

      <div>
        <div class="border border-info bg-light rounded float-right p-2 ml-2 mb-2">
          <div class="toc" id="">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#push-notifications-in-matrix" id="id17">Push notifications in Matrix</a><ul>
<li><a class="reference internal" href="#getting-notifications" id="id18">Getting notifications</a></li>
<li><a class="reference internal" href="#getting-events-which-generated-notifications" id="id19">Getting events which generated notifications</a></li>
</ul>
</li>
<li><a class="reference internal" href="#push-rules-background" id="id20">Push rules background</a><ul>
<li><a class="reference internal" href="#getting-the-configured-push-rules" id="id21">Getting the configured push rules?</a></li>
<li><a class="reference internal" href="#what-makes-up-a-push-rule" id="id22">What makes up a push rule?</a></li>
<li><a class="reference internal" href="#types-of-push-rules" id="id23">Types of push rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#why-do-clients-care-doesnt-the-homeserver-do-this-all-for-me" id="id24">Why do clients care? Doesn’t the homeserver do this all for me?</a></li>
<li><a class="reference internal" href="#what-happens-by-default" id="id25">What happens by default?</a><ul>
<li><a class="reference internal" href="#other-standard-rules" id="id26">Other “standard” rules</a></li>
<li><a class="reference internal" href="#what-about-unread-rooms" id="id27">What about unread rooms?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#putting-it-altogether" id="id28">Putting it altogether…</a></li>
</ul>
</div>
        </div>

        <p>In a previous post about <a class="reference external" href="https://patrick.cloke.us/posts/2023/01/05/matrix-read-receipts-and-notifications/">read receipts <span class="amp">&amp;</span> notifications in Matrix</a> I briefly
mentioned that push rules generate notifications, but with little detail. After
completing a rather large project to improve notifications in Matrix I want to
fill in some of those blanks. <a class="footnote-reference" href="#id9" id="id1">[1]</a></p>
<!-- comment:

Adapted from https://docs.google.com/presentation/d/1odrbD5wMwGz_qUtG5U1pFb7p3sFwLApDaYtyHpdI-Oo/edit -->

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These notes are true as of the v1.6 of the Matrix spec and also cover some
Matrix spec changes which may or may not have been merged since.</p>
</div>
<div class="section" id="push-notifications-in-matrix">
<h2><a class="toc-backref" href="#id17">Push notifications in Matrix</a></h2>
<p>Matrix includes a <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#push-notifications">push notifications module</a> which defines when Matrix events
are considered an unread <strong>notification</strong> or <strong>highlight notification</strong> <a class="footnote-reference" href="#id10" id="id2">[2]</a>
and <em>how</em> those events are <strong>sent to third-party push notification services</strong>.</p>
<p><strong>Push rules</strong> are a set of <em>ordered</em> rules which clients upload to the homeserver.
These are shared by all device and are evaluated per event by the homeserver (and
also by clients). <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#predefined-rules">Default push rules</a> are defined in the Matrix spec. Push rules
power the unread (and highlight) counts for each room, push notifications, and the
notifications <span class="caps">API</span>.</p>
<p>Each rule defines <strong>conditions</strong> which must be met for the rule to match and
<strong>actions</strong> to take if the rule matches.</p>
<p>Processing of push rules occur until a rule matches or all rules have been evaluated.</p>
<div class="section" id="getting-notifications">
<h3><a class="toc-backref" href="#id18">Getting notifications</a></h3>
<p>As some background, clients receive notifications in one of two ways, via polling
<tt class="docutils literal">/sync</tt> and/or via push notifications.</p>
<p>Web-based clients often receive events via polling:</p>
<blockquote class="text-center">
<a class="reference external image-reference" href="https://patrick.cloke.us/images/matrix-push-rules-and-notifications/web-push-flow.png"><img alt="Notification flow for web applications." src="/thumbnails/matrix-push-rules-and-notifications/web-push-flow_medium.png"/></a>
</blockquote>
<p>The <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#_matrixclientv3sync_unread-notification-counts">sync response</a> (both initial and incremental) include the count of unread
notifications and unread highlight notifications per room.</p>
<p>Mobile applications often <a class="reference external" href="https://spec.matrix.org/v1.6/push-gateway-api/#overview">receive events via push</a> <a class="footnote-reference" href="#id11" id="id3">[3]</a>:</p>
<blockquote class="text-center">
<a class="reference external image-reference" href="https://patrick.cloke.us/images/matrix-push-rules-and-notifications/mobile-push-flow.png"><img alt="Notification flow for mobile applications." src="/thumbnails/matrix-push-rules-and-notifications/mobile-push-flow_medium.png"/></a>
</blockquote>
<p>Push notifications include the event information (or just the event <span class="caps">ID</span>) and
whether the event was a highlight notification. (The event being pushed implies
it increased the notification count.)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The deployment of the push gateway must be paired with the application (the
push keys must be paired). I.e. if you make your own application (or even
your own build of Element iOS / Android) you cannot re-use the deployment at
matrix.org and must have your own deployment.</p>
</div>
</div>
<div class="section" id="getting-events-which-generated-notifications">
<h3><a class="toc-backref" href="#id19">Getting events which generated notifications</a></h3>
<p>There’s <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#listing-notifications">an <span class="caps">API</span> to retrieve a list of events</a> which the user has been notified
about. This powers the “notification panel” on Element Web and is meant to help
users catch-up on missed notifications.</p>
<p>It is fairly underspecified and the Synapse implementation has limitations:</p>
<ul class="simple">
<li>Highlight notifications are only kept for 30 days</li>
<li>Non-highlight notifications are only kept for 72 hours</li>
</ul>
<p>Additionally it <a class="reference external" href="https://github.com/vector-im/element-web/issues/6874">works poorly for encrypted rooms</a>.</p>
</div>
</div>
<div class="section" id="push-rules-background">
<h2><a class="toc-backref" href="#id20">Push rules background</a></h2>
<div class="section" id="getting-the-configured-push-rules">
<h3><a class="toc-backref" href="#id21">Getting the configured push rules?</a></h3>
<p>There’s a <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#push-rules-api">set of APIs to fetch or modify push rules</a>, they let you:</p>
<ul class="simple">
<li>Fetch all push rules</li>
<li>Create or delete an individual push rule</li>
<li>Fetch or update an individual push rule’s actions</li>
<li>Fetch or enable/disable an individual push rule</li>
</ul>
<p>An initial sync includes all of a user’s push rules under the user’s account data.</p>
<p>Any changes to push rules are included in incremental syncs. <em>Except</em> for newly
added rules to the specification (this is likely a homeserver bug).</p>
<p>Note that you cannot use <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#client-config">the account data APIs</a> to configure push rules. <a class="footnote-reference" href="#id12" id="id4">[4]</a></p>
</div>
<div class="section" id="what-makes-up-a-push-rule">
<h3><a class="toc-backref" href="#id22">What makes up a push rule?</a></h3>
<p>A push rule is a <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#_matrixclientv3pushrules_pushrule"><span class="caps">JSON</span> object with the following fields</a>:</p>
<ul class="simple">
<li><tt class="docutils literal">rule_id</tt>: Unique (per-user) <span class="caps">ID</span> for the rule.<ul>
<li>The <tt class="docutils literal">rule_id</tt> for default rules have a special form (they start with a
dot: <tt class="docutils literal">.</tt>).</li>
</ul>
</li>
<li><tt class="docutils literal">default</tt>: Whether the rule is part of the predefined set of rules.</li>
<li><tt class="docutils literal">enabled</tt>: Whether the rule is enabled.</li>
<li><tt class="docutils literal">conditions</tt>: an array of 0 or more conditions to match.</li>
<li><tt class="docutils literal">actions</tt>: 0 or more actions to take if the rule matches.</li>
</ul>
<p>All conditions must match for a push rule to match. If there are no conditions,
then the push rule always matches. Possible conditions include:</p>
<ul class="simple">
<li>Check event properties against patterns or exact values<ul>
<li>Strings can be compared via globbing or exact values.</li>
<li>The globbing behavior changes if you’re checking the <tt class="docutils literal">body</tt> property or not.</li>
</ul>
</li>
<li>Check against the number of room members<ul>
<li>Used to (incorrectly) check if a room is a direct message.</li>
</ul>
</li>
<li>Check if a user can <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#mroompower_levels">perform an action</a> via power rules<ul>
<li>The only defined option is whether a user can send @room.</li>
</ul>
</li>
</ul>
<p>Push rule actions define <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#actions">what to do once a push rule</a> matches an event.</p>
<ul class="simple">
<li><tt class="docutils literal">notify</tt>: increment the notification count and send a push notification. Uses
“tweaks” to optionally:<ul>
<li>Play a sound.</li>
<li>Create a highlight notification, this causes the highlight count to be
incremented (in addition to the notification count).</li>
</ul>
</li>
<li>Can be an empty list to do nothing.</li>
</ul>
<p>There are other undefined or no-op actions (<tt class="docutils literal">dont_notify</tt>, <tt class="docutils literal">coalesce</tt>) which will be
removed in the next version of the spec. <a class="footnote-reference" href="#id13" id="id5">[5]</a></p>
</div>
<div class="section" id="types-of-push-rules">
<h3><a class="toc-backref" href="#id23">Types of push rules</a></h3>
<p>Push rules have a type associated with them, these are executed in order:</p>
<ul class="simple">
<li>Override: generic high priority rules</li>
<li>Content-specific: applies to messages which have a <tt class="docutils literal">body</tt> that matches a <tt class="docutils literal">pattern</tt></li>
<li>Room-specific: applies to messages of a room</li>
<li>Sender-specific: applies to messages from a sender</li>
<li>Underride: generic low priority rules</li>
</ul>
<p>The previously discussed shape of push rules is not the full story! There are
special cases which do not accept conditions, but can be mapped to them.</p>
<ul class="simple">
<li>Content-specific: has a <tt class="docutils literal">pattern</tt> field which maps to a pattern against the
<tt class="docutils literal">body</tt> property.</li>
<li>Room-specific: the <tt class="docutils literal">rule_id</tt> is re-used to match against the room <span class="caps">ID</span>.</li>
<li>Sender-specific: the <tt class="docutils literal">rule_id</tt> is re-used to match against the event <tt class="docutils literal">sender</tt>.</li>
</ul>
</div>
</div>
<div class="section" id="why-do-clients-care-doesnt-the-homeserver-do-this-all-for-me">
<h2><a class="toc-backref" href="#id24">Why do clients care? Doesn’t the homeserver do this all for me?</a></h2>
<p>Encryption ruins everything! Some of the push rules require the decrypted event
content to be properly processed. The enable this, the default rules declare
<strong>all encrypted events as notifications</strong>. Clients are expected to
<strong>re-run push rules on the decrypted content</strong>. <a class="footnote-reference" href="#id14" id="id6">[6]</a></p>
<p>This can result in one of the following: <a class="footnote-reference" href="#id15" id="id7">[7]</a></p>
<ul class="simple">
<li>Increment the highlight count (the decrypted event results in a highlight)</li>
<li>No change (the decrypted event results in a notification)</li>
<li>Decrement notification counts (the decrypted event results in no notification)</li>
</ul>
<p>Due to gappy syncs clients frequently can only make a best estimate of the true
unread / highlight count of events in encrypted rooms.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Element iOS / Android get encrypted events pushed to them, but do not properly
implement mentions <span class="amp">&amp;</span> keywords.</p>
</div>
</div>
<div class="section" id="what-happens-by-default">
<h2><a class="toc-backref" href="#id25">What happens by default?</a></h2>
<p>The <a class="reference external" href="https://spec.matrix.org/v1.6/client-server-api/#predefined-rules">default rules are in the Matrix spec</a> and include:</p>
<ul class="simple">
<li>Highlight:<ul>
<li>Tombstones</li>
<li>Room <span class="amp">&amp;</span> user mentions</li>
</ul>
</li>
<li>Do nothing:<ul>
<li>Notice messages</li>
<li>Other room member events</li>
<li>Server <span class="caps">ACL</span> updates</li>
</ul>
</li>
<li>Notification:<ul>
<li>Invites to me</li>
<li>Messages and encrypted events in non-DMs</li>
</ul>
</li>
<li>Notification with sound:<ul>
<li>Incoming calls</li>
<li>Messages and encrypted events in DMs</li>
</ul>
</li>
</ul>
<p>Default rules can be disabled or have their actions modified on a per-user basis.
Some of the above features are handled by multiple push rules.</p>
<div class="section" id="other-standard-rules">
<h3><a class="toc-backref" href="#id26">Other “standard” rules</a></h3>
<p>Element creates custom push rules based on a known form. <a class="footnote-reference" href="#id16" id="id8">[8]</a></p>
<ul class="simple">
<li>Keywords (implemented as a content-specific rule with a pattern)</li>
<li>Per-room overrides:<ul>
<li>All messages (implemented as a room-specific rule with a notify action)</li>
<li>Mentions <span class="amp">&amp;</span> keywords (implemented as a room-specific rule with no actions)</li>
<li>Mute (implemented as an override rule to match the room <span class="caps">ID</span> with no actions)</li>
</ul>
</li>
</ul>
<p>Matrix also allows defining arbitrary rules (e.g. to change behavior for particular
rooms, senders, message types, etc.)</p>
</div>
<div class="section" id="what-about-unread-rooms">
<h3><a class="toc-backref" href="#id27">What about unread rooms?</a></h3>
<p>The unread (“bold”) rooms logic in Element Web is completely custom and outside
of the Matrix specification.</p>
<ul class="simple">
<li>Will the <a class="reference external" href="https://github.com/matrix-org/matrix-react-sdk/blob/d33e416fc75369d3fec1c1f27ef9d5b2ea0b3703/src/shouldHideEvent.ts#L58-L82">event be shown</a> ?</li>
<li>Is it <a class="reference external" href="https://github.com/matrix-org/matrix-react-sdk/blob/d33e416fc75369d3fec1c1f27ef9d5b2ea0b3703/src/Unread.ts#L41-L48">not an ignored event type</a> ?</li>
<li>Is it <a class="reference external" href="https://github.com/matrix-org/matrix-react-sdk/blob/d33e416fc75369d3fec1c1f27ef9d5b2ea0b3703/src/Unread.ts#L52">not redacted</a> ?</li>
<li>Does a <a class="reference external" href="https://github.com/matrix-org/matrix-react-sdk/blob/d33e416fc75369d3fec1c1f27ef9d5b2ea0b3703/src/Unread.ts#L53">renderer exist for the event</a> ?</li>
</ul>
<p>Note that if you enable hidden events (or tweak other options to show events)
then the behavior changes!</p>
</div>
</div>
<div class="section" id="putting-it-altogether">
<h2><a class="toc-backref" href="#id28">Putting it altogether…</a></h2>
<p>…it gets complicated trying to figure out whether a message will generate a
notification or not.</p>
<blockquote class="text-center">
<a class="reference external image-reference" href="https://patrick.cloke.us/images/matrix-push-rules-and-notifications/default-push-rules.png"><img alt="Flow chart of the default Matrix push rules when using Element." src="/thumbnails/matrix-push-rules-and-notifications/default-push-rules_medium.png"/></a>
<p>The default Matrix push rules (also showing the options available within Element).</p>
</blockquote>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Improving unintentional mentions (<a class="reference external" href="https://github.com/matrix-org/matrix-spec-proposals/pull/3952"><span class="caps">MSC3952</span></a>) is the main feature we were
working on, but this was powered by …</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><p class="first">Notification count (the grey badge with count in Element Web) is the number
of unread messages in a room. Highlight count (the red badge with count in
Element Web) is the number of unread mentions in a room.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The unread (“bold”) rooms feature in Element Web, which represents a room
with unread messages (but no notification count) is not powered by push
rules (and is not specced).</p>
</div>
<p class="last">See the <a class="reference external" href="https://github.com/matrix-org/matrix-react-sdk/blob/develop/docs/room-list-store.md#list-ordering-algorithm-importance">Element Web docs on the room list</a>.</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>This post generally defines “push notifications” as a notification which
is sent via a push provider to an application. Push providers include Apple,
Google, Microsoft, or Mozilla.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="https://github.com/matrix-org/matrix-spec-proposals/pull/4010"><span class="caps">MSC4010</span></a> aims to make this explicit.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>See <a class="reference external" href="https://github.com/matrix-org/matrix-spec-proposals/pull/3987"><span class="caps">MSC3987</span></a>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td>It was not clear how clients should handle encrypted events <a class="reference external" href="https://github.com/matrix-org/matrix-spec/pull/1461">until recently</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td>Adapted from a <a class="reference external" href="https://gist.github.com/Half-Shot/f9501916363894761a1659250aa25181">Gist from Half-Shot</a>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[8]</a></td><td>These don’t seem to be specced, I’m unsure if other clients create similar
rules or understand these rules.</td></tr>
</tbody>
</table>
</div>

      </div>

<div id="disqus_thread"></div>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = '/posts/2023/05/08/matrix-push-rules-notifications/';
this.page.identifier = 'matrix-push-rules-notifications';
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://clokep.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </div>
</div>

    <nav class="navbar fixed-bottom navbar-light bg-light border-top border-info">
      <a href="https://getpelican.com/" class="nav-item" target="_blank">Powered by Pelican</a>
      <a href="https://github.com/clokep/clokep.github.io" class="nav-item" target="_blank">
        Source available on GitHub <span class="fab fa-github"></span>
      </a>
    </nav>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>

  </body>
</html>